Search.setIndex({"docnames": ["advanced", "basic", "index", "intermediate", "prepare", "readme"], "filenames": ["advanced.rst", "basic.rst", "index.rst", "intermediate.rst", "prepare.rst", "readme.md"], "titles": ["Accelerator: IPU training", "Accelerator: IPU training", "Accelerator: IPU training", "Accelerator: IPU training", "Hardware agnostic training (preparation)", "Lightning \u26a1 GraphCore"], "terms": {"audienc": [0, 1, 3, 5], "user": [0, 1, 3, 5], "look": [0, 1, 3, 5], "custom": [0, 1, 2, 4, 5], "massiv": [0, 2], "provid": [0, 1, 3, 5], "further": 0, "optim": [0, 1, 4, 5], "speed": 0, "up": 0, "By": [0, 3], "us": [0, 1, 3, 5], "ipustrategi": [0, 3], "we": [0, 4], "can": [0, 1, 3, 4, 5], "set": [0, 1, 2, 3, 5], "device_iter": 0, "which": [0, 1, 3, 4, 5], "control": 0, "number": [0, 1, 4, 5], "iter": 0, "run": [0, 2, 4], "directli": 0, "devic": [0, 1, 3, 4, 5], "befor": [0, 4], "return": [0, 4], "host": [0, 1, 5], "increas": [0, 3], "improv": 0, "throughput": 0, "i": [0, 3, 4], "less": 0, "commun": [0, 4], "requir": [0, 1, 5], "when": [0, 1, 4, 5], "hard": 0, "ensur": [0, 1, 4, 5], "fulli": [0, 1, 5], "satur": 0, "via": [0, 3, 4], "micro": 0, "batch": [0, 1, 4, 5], "see": [0, 1, 3, 4, 5], "more": [0, 1, 5], "inform": [0, 1, 5], "import": [0, 3, 4, 5], "lightn": [0, 1, 2, 3, 4], "pytorch": [0, 1, 3, 4, 5], "pl": [0, 3], "from": [0, 1, 3, 5], "strategi": [0, 1, 3, 5], "mylightningmodul": [0, 3], "trainer": [0, 1, 3, 4, 5], "8": [0, 1, 3, 5], "32": [0, 3], "fit": [0, 3], "note": [0, 4], "default": [0, 1, 3, 5], "last": 0, "loss": [0, 3, 4], "you": [0, 1, 3, 4, 5], "overrid": 0, "thi": [0, 1, 3, 4, 5], "pass": 0, "your": [0, 1, 2, 3, 4, 5], "own": 0, "poptorch": 0, "anchormod": 0, "describ": 0, "document": [0, 1, 5], "inference_opt": 0, "deviceiter": 0, "training_opt": 0, "all": [0, 3, 4], "also": [0, 3, 4], "plugin": 0, "due": [0, 1, 5], "architectur": [0, 1, 5], "larger": [0, 1, 5], "should": 0, "across": [0, 1, 4, 5], "design": 0, "current": [0, 1, 3, 5], "capabl": 0, "annot": 0, "execut": 0, "below": 0, "an": 0, "exampl": [0, 1, 4, 5], "block": 0, "lightningmodul": [0, 4], "do": [0, 1, 4, 5], "infer": 0, "done": [0, 4], "themselv": 0, "If": 0, "specifi": 0, "4": [0, 1, 5], "differ": [0, 1, 5], "id": 0, "defin": 0, "mean": [0, 4], "split": 0, "onto": 0, "mutual": 0, "exclus": 0, "flag": [0, 3], "In": 0, "other": [0, 1, 5], "word": 0, "2": [0, 1, 4, 5], "total": 0, "data": [0, 1, 5], "replic": 0, "two": 0, "time": 0, "pipelin": 0, "must": [0, 1, 5], "full": 0, "e": [0, 1, 5], "whilst": 0, "one": [0, 1, 5], "process": [0, 1, 4, 5], "start": [0, 1, 5], "next": 0, "For": 0, "least": 0, "class": [0, 1, 4, 5], "def": [0, 4], "__init__": [0, 4], "self": [0, 1, 4, 5], "super": [0, 4], "place": 0, "layer1": 0, "layer2": 0, "layer3": 0, "layer4": 0, "softmax": 0, "runtim": 0, "beginblock": 0, "new": [0, 4], "layer": 0, "within": [0, 4], "torch": [0, 1, 4], "nn": 0, "linear": 0, "5": [0, 4], "10": 0, "ipu_id": 0, "0": [0, 4], "ad": [0, 4], "subsequ": 0, "till": [0, 1, 5], "ha": [0, 1, 4, 5], "been": 0, "declar": 0, "1": [0, 1, 5], "creat": [0, 4], "dim": 0, "3": [0, 4], "20": 0, "context": 0, "manag": 0, "forward": [0, 4], "function": [0, 1, 4, 5], "ani": [0, 1, 2, 4, 5], "step": [0, 1, 4, 5], "act": 0, "relu": 0, "x": [0, 4], "save": [1, 5], "monei": [1, 5], "larg": [1, 5], "model": [1, 2, 3, 5], "faster": [1, 5], "singl": [1, 2, 5], "multipl": [1, 4, 5], "The": [1, 3, 4, 5], "graphcor": [1, 2, 3], "intellig": [1, 5], "unit": [1, 5], "built": [1, 4, 5], "artifici": [1, 5], "machin": [1, 5], "learn": [1, 2, 5], "consist": [1, 5], "mani": [1, 5], "individu": [1, 5], "core": [1, 5], "call": [1, 5], "tile": [1, 5], "allow": [1, 5], "highli": [1, 5], "parallel": [1, 5], "comput": [1, 4, 5], "high": [1, 5], "bandwidth": [1, 5], "between": [1, 5], "facilit": [1, 5], "load": [1, 5], "where": [1, 3, 5], "essenti": [1, 5], "becaus": [1, 5], "heavili": [1, 5], "oper": [1, 5], "wai": [1, 5], "convent": [1, 5], "cpu": [1, 4, 5], "gpu": [1, 4, 5], "size": [1, 5], "maximum": [1, 5], "compil": [1, 5], "graph": [1, 5], "reli": [1, 5], "util": [1, 3, 5], "ar": [1, 3, 4, 5], "build": [1, 4, 5], "pod": [1, 5], "rack": [1, 5], "base": [1, 5], "system": [1, 5], "workload": [1, 5], "glossari": [1, 5], "definit": [1, 4, 5], "specif": [1, 5], "terminologi": [1, 5], "To": [1, 3, 4, 5], "enabl": [1, 3, 5], "simpli": [1, 5], "paramet": [1, 4, 5], "power": [1, 5], "16": [1, 5], "avail": [1, 5], "auto": [1, 5], "equival": [1, 5], "choos": [1, 5], "automat": [1, 4, 5], "have": [1, 3, 4, 5], "get": [1, 4, 5], "popart": [1, 5], "poplar": [1, 5], "packag": [1, 5], "sdk": [1, 5], "instruct": [1, 5], "guid": [1, 5], "portal": [1, 5], "some": [1, 4, 5], "being": [1, 5], "address": [1, 5], "futur": [1, 5], "make": [1, 5], "experi": [1, 5], "seamless": [1, 5], "move": [1, 4, 5], "pleas": [1, 5], "mnist": [1, 5], "displai": [1, 5], "most": [1, 5], "overcom": [1, 5], "them": [1, 5], "thei": [1, 4, 5], "resolv": [1, 5], "log": [1, 5], "support": [1, 3, 5], "training_step": [1, 5], "validation_step": [1, 4, 5], "test_step": [1, 4, 5], "predict_step": [1, 5], "trace": [1, 5], "sent": [1, 5], "sinc": [1, 5], "branch": [1, 5], "logic": [1, 5], "form": [1, 5], "primit": [1, 5], "valu": [1, 5], "constant": [1, 5], "Be": [1, 5], "mind": [1, 5], "could": [1, 5], "lead": [1, 4, 5], "error": [1, 4, 5], "code": [1, 2, 4, 5], "clip": [1, 5], "gradient": [1, 5], "It": [1, 4, 5], "possibl": [1, 4, 5], "batchsampl": [1, 5], "dataload": [1, 4, 5], "handl": [1, 4, 5], "transfer": [1, 5], "henc": [1, 5], "hook": [1, 5], "transfer_batch_to_devic": [1, 5], "on_after_batch_transf": [1, 5], "appli": [1, 5], "here": [1, 4, 5], "overridden": [1, 5], "except": [1, 5], "rais": [1, 5], "prepar": 2, "option": [2, 4], "hardwar": 2, "basic": 2, "multi": 2, "intermedi": 2, "tune": 2, "perform": [2, 3, 4], "mix": 2, "precis": 2, "analys": 2, "advanc": 2, "techniqu": 2, "index": 2, "modul": [2, 4], "search": 2, "page": 2, "analysi": 3, "tool": 3, "dynam": 3, "scale": [3, 4], "pure": 3, "weight": 3, "half": 3, "integr": 3, "help": [3, 4], "metric": [3, 4], "dure": [3, 4], "lifecycl": 3, "onc": 3, "gain": 3, "access": [3, 4], "download": 3, "websit": 3, "dump": [3, 4], "report": 3, "directori": 3, "open": 3, "autoreport_dir": 3, "report_dir": 3, "tpu": 4, "without": 4, "chang": 4, "need": 4, "few": 4, "good": 4, "habit": 4, "layer_1": 4, "x_hat": 4, "after": 4, "arbitrari": 4, "z": 4, "know": 4, "what": 4, "refer": 4, "sometim": 4, "necessari": 4, "store": 4, "attribut": 4, "howev": 4, "remain": 4, "even": 4, "prevent": 4, "regist": 4, "buffer": 4, "method": 4, "litmodel": 4, "sigma": 4, "ey": 4, "now": 4, "anywher": 4, "distributedsampl": 4, "distribut": 4, "mode": 4, "sync_dist": 4, "true": 4, "each": 4, "worker": 4, "same": 4, "behaviour": 4, "track": 4, "checkpoint": 4, "later": 4, "downstream": 4, "task": 4, "best": 4, "awar": 4, "signific": 4, "overhead": 4, "slow": 4, "down": 4, "torchmetr": 4, "updat": 4, "batch_idx": 4, "y": 4, "logit": 4, "add": 4, "sync": 4, "mai": 4, "impact": 4, "validation_loss": 4, "on_step": 4, "on_epoch": 4, "test_loss": 4, "manual": 4, "reduc": 4, "result": 4, "rank": 4, "follow": 4, "output": 4, "append": 4, "on_test_epoch_end": 4, "all_gath": 4, "clear": 4, "free": 4, "memori": 4, "onli": 4, "don": 4, "t": 4, "forget": 4, "rank_zero_onli": 4, "avoid": 4, "deadlock": 4, "caveat": 4, "monitor": 4, "unimpl": 4, "http": 4, "github": 4, "com": 4, "ai": 4, "issu": 4, "15852": 4, "is_global_zero": 4, "my_reduced_metr": 4, "": 4, "veri": 4, "like": 4, "alreadi": 4, "case": 4, "_launch": 4, "process_obj": 4, "file": 4, "net": 4, "softwar": 4, "local": 4, "python": 4, "6": 4, "lib": 4, "python3": 4, "multiprocess": 4, "popen_spawn_posix": 4, "py": 4, "line": 4, "47": 4, "reduct": 4, "fp": 4, "60": 4, "forkingpickl": 4, "protocol": 4, "obj": 4, "_pickl": 4, "picklingerror": 4, "pickl": 4, "lambda": 4, "0x2b599e088ae8": 4, "lookup": 4, "__main__": 4, "fail": 4, "someth": 4, "transform": 4, "callback": 4, "cannot": 4, "some_object": 4, "limit": 4, "fix": 4, "find": 4, "piec": 4, "end": 4, "stacktrac": 4, "usual": 4, "ie": 4, "seem": 4, "somewher": 4, "THE": 4, "thing": 4, "TO": 4, "AND": 4, "acceler": 5, "pip": 5, "u": 5, "modelhook": 5}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"acceler": [0, 1, 2, 3], "ipu": [0, 1, 2, 3, 5], "train": [0, 1, 2, 3, 4], "advanc": 0, "option": 0, "model": [0, 4], "parallel": 0, "what": [1, 5], "i": [1, 5], "an": [1, 5], "run": [1, 5], "how": [1, 5], "access": [1, 5], "known": [1, 5], "limit": [1, 5], "start": 2, "here": 2, "indic": 2, "tabl": 2, "mix": 3, "precis": 3, "16": 3, "bit": 3, "popvis": 3, "graph": 3, "analys": 3, "hardwar": 4, "agnost": 4, "prepar": 4, "delet": 4, "cuda": 4, "call": 4, "init": 4, "tensor": 4, "us": 4, "register_buff": 4, "remov": 4, "sampler": 4, "synchron": 4, "valid": 4, "test": 4, "log": 4, "make": 4, "pickleabl": 4, "lightn": 5, "graphcor": 5, "instal": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Accelerator: IPU training": [[0, "accelerator-ipu-training"], [1, "accelerator-ipu-training"], [2, "accelerator-ipu-training"], [3, "accelerator-ipu-training"]], "Advanced IPU options": [[0, "advanced-ipu-options"]], "Model parallelism": [[0, "model-parallelism"]], "What is an IPU?": [[1, "what-is-an-ipu"], [5, "what-is-an-ipu"]], "Run on IPU": [[1, "run-on-ipu"], [5, "run-on-ipu"]], "How to access IPUs": [[1, "how-to-access-ipus"], [5, "how-to-access-ipus"]], "Known limitations": [[1, "known-limitations"], [5, "known-limitations"]], "Start here": [[2, null]], "Indices and tables": [[2, "indices-and-tables"]], "Mixed precision & 16 bit precision": [[3, "mixed-precision-16-bit-precision"]], "PopVision Graph Analyser": [[3, "popvision-graph-analyser"]], "Hardware agnostic training (preparation)": [[4, "hardware-agnostic-training-preparation"]], "Delete .cuda() or .to() calls": [[4, "delete-cuda-or-to-calls"]], "Init tensors using Tensor.to and register_buffer": [[4, "init-tensors-using-tensor-to-and-register-buffer"]], "Remove samplers": [[4, "remove-samplers"]], "Synchronize validation and test logging": [[4, "synchronize-validation-and-test-logging"]], "Make models pickleable": [[4, "make-models-pickleable"]], "Lightning \u26a1 GraphCore": [[5, "lightning-graphcore"]], "Installation": [[5, "installation"]]}, "indexentries": {}})